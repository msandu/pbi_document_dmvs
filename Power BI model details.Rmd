---
title: "Power BI model details"
author: "Marius Sandu"
date: "11/23/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(RDCOMClient)
library(dplyr)
library(magrittr)
library(data.table)
library(jsonlite)
library(DT)
source('helpers.R')

dmv_queries <- fromJSON("queries/dmv.json")

# TODO: the port can be scanned from the localappdata folder, and the initial catalogue retrieved via a DMV query

con <- COMCreate("ADODB.Connection")
con[["ConnectionString"]] <- paste(
  "Provider=MSOLAP.8",
  "Integrated Security=SSPI",
  "Persist Security Info=True",
  "Data Source=localhost:63231",
  "Initial Catalog=314f0f2c-814f-43c8-bc7b-7c867e7ca52c",
  sep = ";")

con$Open()

```

### Data sources used

The Partition object represents a partition in a table. It is a child of a Table object. The partitions in a table define the data from external data sources that become available when the table is queried.

```{r}

partitions <- get_dmv('TMSCHEMA_PARTITIONS')
partitions %>%
  datatable(
    style = 'bootstrap',
    filter = 'top')

```